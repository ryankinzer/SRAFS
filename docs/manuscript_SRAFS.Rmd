---
title: "Three Decades of ESA-Listing: Are Snake River Spring/summer Chinook Salmon and Steelhead on the Path to Recovery?"
author:
  - name: Ryan N. Kinzer
    title: Research Scientist
    # affil: 1
  - name: Jay Hesse
    title: Director of Biological Services
    # affil: 1
  - name: David B. Johnson
    title: Program Manager
    # affil: 1

affiliations:
  # - id: 1
    name: Nez Perce Tribe, Department of Fisheries Resources Management
    
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  bookdown::pdf_document2:
    citation_package: biblatex #natbib
    keep_tex: yes
    fig_caption: yes
    tables: true
    latex_engine: pdflatex #xelatex
    template: ..\templates\NPT_article_template.tex
  bookdown::word_document2:
    reference_docx: ..\templates\Word_template_draft.docx
    number_sections: false
    toc: false
    toc_levels: 3
  bookdown::html_document2:
    theme: cerulean
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: no
      smooth_scroll: yes
    number_sections: yes
    css: "../templates/styles.css"
    pandoc_args:
    - "--lua-filter=../templates/scholarly-metadata.lua"
    - "--lua-filter=../templates/author-info-blocks.lua"
    - "--lua-filter=../templates/pagebreak.lua"
shorttitle: Chinook and Steelhead Status
geometry: margin=1in
#fontfamily: mathpazo
fontsize: 12pt
branding: yes
linenumbers: no
# abstract:
#   The historic and abundant Snake River returns started declining soon after European settlement beginning in the 1850's due to overharvest, hydropower development, natural resource extraction and urban growth along the Columbia and Snake rivers. Between 1980 and 1990 sp/su Chinook Salmon escapement into the Snake River basin ranged between 3,343 to 21,870 adults. Based on their rapid decline and the low numbers observed the Snake River sp/su Chinook Salmon evolutionary significant unit (ESU) was listed as threatened under the Endangered Species Act (ESA) in 1992 (57 FR 14653). During the same period, the returning Snake River summer steelhead distinct population segment (DPS) experienced similar rates of decline, with an average annual return of only 9,400 when they were listed as threatened under ESA in 1997 (62 FR 43937)
# keywords: pacific salmon, steelhead, 
csl: "../templates/american-fisheries-society.csl"
bibliography: 
  - abundance-decline.bib
  - packages.bib
link-citations: true
always_allow_html: yes
---

```{r setup, include=FALSE}
library(knitr)
library(kableExtra)

opts_chunk$set(echo = FALSE, message = FALSE, error = FALSE, warning = FALSE)

# default options for tables
options(knitr.kable.NA = '-')

# when knitting to Word, use this
# what kind of document is being created?
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')

if(!(is.null(doc.type)) && doc.type == 'docx') {
  options(knitr.table.format = "pandoc")
}

if(!(is.null(doc.type)) && doc.type %in% c("docx", "html")) {
  theme_set(theme_pubr(base_family = "Times New Roman"))
}
```

```{r load-pkgs}
library(tidyverse)
library(sf)
library(scales)
library(ggmap)
library(maps)
source('../R/theme_rk.R')
source('../R/summarize_ModelFits.R')

# set default theme for ggplot2
#theme_set(theme_pubr())
```

```{r package-bibtex, eval = TRUE}
knitr::write_bib(c("tidyverse",
                   "MARSS",
                   "knitr", 
                   "rmarkdown",
                   "ggpubr",
                   "sf",
                   "scales",
                   "ggmap",
                   "maps",
                   "dabom",
                   "stadem"),
                 file = 'packages.bib')
```


```{r set-params}
yr <- 2024
fig_path <- here::here('figures','/')
```

# Background

Freshwater and marine fish species are declining globally due to a variety of stressors, including habitat loss, overfishing, climate change, and pollution. Freshwater species have experienced an alarming 83% decline in monitored populations since 1970, with significant losses observed in the Pacific region [@wwf_living_2022]. A recent study conducted for the International Union for the Conservation of Nature (IUCN)'s Red List of Threatened Species found 25% of all freshwater species are at high risk of extinction [@sayer_one-quarter_2025]. Similarly, marine species such as Atlantic Cod *Gadus morhua* and Bluefin Tuna *Thunnus thynnus* have suffered steep population declines from over exploitation and environmental changes [@fao_state_2020]. The downward patterns and root causes are shared with most North American diadromous fish as well [@waldman_north_2022], and mirrored by populations of anadromous salmonids along the western coast of the United States, where fish abundance has been negatively impacted since commercial harvest began with European settlement [@chapman_salmon_1986] and continues to be threatened from altered river flows, warming waters, natural resource extraction, and habitat fragmentation caused by hydropower and urban development [@nehlsen_pacific_1991].

<!-- Sherman et al. 2023 - extinction risk of coral reef sharks and rays-->

<!-- Storch 2022 - Snake River declines -->
<!-- Lackey 2009 - wide spread declines: identifies reasons for declines and our failure to recover based on political positions-->
<!-- Schoen et al. 2023 - 81% below average in Yukon: maturing at smaller sizes, difference response to climate change for salmon speceis, some decline, some increase, abundance and size related to climate change -->
<!-- Feddern 2024 - decrease productivity: body size and early marine conditions drive changes in productivity across nothern latitudes-->
 <!-- Important for Southern resident Killer Whale population (**Conture et al. 2024, Chasco et al. 2017)**). -->
 
 <!-- All salmon are facing threats, Snake river salmon and steelhead face many threats. Some within our control (freshwater habitat, human caused barriers, hydrosystems) and some not (climate change). For them to have a chance we need to remove the threats that we can influence and control.  -->

Nowhere are these declines more evident than in the Columbia River basin, a critical habitat for pacific salmonid species, including Chinook Salmon *O. tshawytscha* and steelhead *O. mykiss*. Historically Chinook Salmon and steelhead returned to the Columbia River basin in the millions, estimated returns range between 5 and 16 million fish annually [@chapman_salmon_1986; @isab_density_2015; @npcc_compilation_1986], with spring and summer (sp/su) Chinook Salmon making up the largest component (2.5-3.0 million) and steelhead returns consisting of approximately 450-550 thousand individuals [@chapman_salmon_1986]. @chapman_historical_2003 later decomposed total Columbia River returns into Snake River specific stocks, a major tributary of the Columbia River, finding the Snake River contained the majority of available Columbia River spawning habitat, which suggests historic returns of sp/su Chinook Salmon to the Snake River were approximately 1.4-2.2 million with an additional 250-400 thousand steelhead.

The largest loss of Snake River returns are observed during the period of hydroelectric dam construction along the Columbia and Lower Snake rivers beginning with Bonneville Dam in 1933 and ending with Lower Granite Dam in 1978. Between 1980 and 1990 sp/su Chinook Salmon escapement into the Snake River basin ranged between 3,343 to 21,870 adults (57 FR 14653)[@noauthor_federal_1992]. Based on their rapid decline and low numbers relative to their large geographical area of occupancy the Snake River sp/su Chinook Salmon evolutionary significant unit (ESU) was listed as threatened under the Endangered Species Act (ESA) in 1992 (57 FR 14653)[@noauthor_federal_1992]. During the same period, the returning Snake River summer steelhead distinct population segment (DPS) experienced similar rates of decline, with an average annual return of only 9,400 when they were listed as threatened under ESA in 1997 (62 FR 43937) [@noauthor_federal_1997]. 

The Snake River sp/su Chinook Salmon ESU and steelhead DPS historically supported 68 sp/su Chinook Salmon and 40 steelhead populations located across central Idaho, southeast Washington, and northeast Oregon ([@cbp_vision_2020]; Figure \@ref(fig:esu-map)). These historical populations contained 88% of the total spawning habitat in the Columbia River Basin [@chapman_historical_2003]. However, habitat accessibility was permanently reduced to 41 sp/su Chinook Salmon and 24 steelhead populations after the completion of Dworshak Dam on the North Fork Clearwater River in 1969 and the three Hellâ€™s Canyon project dams on the upper Snake River River from 1959-1967 which lacked fish passage facilities. The resulting habitat loss led to the immediate extinction of 60% of the historical populations in the Snake River basin. With the remaining populations at historically low abundances and facing continued threats of habitat degradation, hydrosystem impacts, and a rapidly changing climate [@noaa_rebuilding_2022; @crozier_climate_2021; @nakamura_divergent_2023]. 

 <!-- @chapman_salmon_1986 estimated 7.5-8.8 million; 5-9 million [@isabDensityDependenceIts2015] or between 10 - 16 million [@NPCC1986]. -->

<!-- In particular, the Snake River Basin, a major tributary of the Columbia River, has seen dramatic reductions in salmon returns over the past century. -->

<!-- Historical estimates suggest that 1.5 million wild salmon once returned annually to the Snake River, but today, only a fraction of that number remains, with some populations listed as endangered under the Endangered Species Act (USGS, 2024).  -->

<!-- This decline is attributed to barriers such as dams that impede migration, degraded spawning habitats, and changing ocean conditions that affect survival rates. Addressing these declines is critical not only for preserving biodiversity but also for sustaining the cultural and economic importance of these fish to the region. -->

After ESA listing of Snake River anadromous fish regulatory agencies established methods to asses population viability. Population viability and extinction is commonly thought of as a stochastic event with risk conveyed probabilistically, requiring thresholds for population persistence, and determined through "rules of thumb", analytical, or simulation studies [@thompson_determining_1991]. Often, population viability occurs at a point when abundance or other metrics indicate the probability of persistence is greater than 0.95. Similarly, population viability evaluations can examine the opposite and determine at which point is the probability of extinction greater than 0.95, thus, indicating the point at which the population is at high risk of extinction and unlikely to recover [@thompson_determining_1991]. The viability of Snake River sp/su Chinook Salmon and steelhead is assessed using a combination of minimum abundance thresholds (MAT), productivity, genetic diversity, and spatial distribution metrics [@mcelhany_viable_2000; @ictrt_viability_2007]. Minimum abundance thresholds for each population were developed independently using available habitat and intrinsic potential models [@cooney_appendix_2006], with MAT for individual populations ranging from 500-2,000 sp/su Chinook Salmon and 500-1,500 steelhead [@ictrt_viability_2007]. At these established MAT levels populations were determined to be viable and have a low risk of extinction [@noaa_esa_2017]. Conversely, @ictrt_viability_2007 also established a quasi-extinction threshold (QET) for each population at 50 or fewer spawners for four consecutive years to determine the point when extinction was likely. And recently, in 2020, Columbia River and Snake River fisheries co-managers recognized population viability thresholds were far below desired levels in order to meet ecological and state and tribal harvest needs. In collaboration with the regulatory agencies the co-managers formed the Columbia Basin Partnership (CBP) and developed common abundance goals focused on healthy, harvestable, and sustainable levels capable of supporting ecosystem processes [@cbp_vision_2020]. These established "healthy and harvestable" levels, combined with population viability thresholds, form an agreed upon, and complete set of abundance evaluation points to determine a population's recovery status.

Three decades have passed since the ESA listing of Snake River sp/su Chinook Salmon and steelhead, and during this time, one of the largest and most expensive species recovery efforts has unfolded. Approximately 17 billion dollars has been spent in the Columbia River basin to protect and restore habitat, improve survival through mainstem hydrosystems, provide fisheries with hatchery production, and to rebuild natural populations through supplementation efforts (**citation**), yet, annual fish runs continue to be only 1% of historical levels [@thurow_wild_2019; @storch_review_2022; @ford_biological_2022]. Our aim for this research is to provide an updated current status and future predicted status of Snake River sp/su Chinook Salmon and steelhead populations relative to agreed upon abundance evaluation points [@cbp_vision_2020]. To establish the current status and trends of Snake River populations we first fit multivariate dynamic linear models (DLM) to empirical population abundance estimates, similar to @ford_biological_2022 methodology, to identify common patterns across populations. Second, we use the best fitting DLM to estimate population trends and annual growth rates for the most recent 10 year period to evaluation recovery status **(we could include a comparison to previous 10-year periods)**. Third, we summarize the percent of populations currently, or predicted, above or below abundance evaluation points, and finally, we discuss our findings in relation to other studies regarding Snake River anadromous fish population status.

```{r load-map-data}
# Load datasets ----
# Get states
user_path <- Sys.getenv('OneDrive')
proj_path <- '/Projects/DFRM Projects/River_Mapping/data/'
spatial_files <- paste0(user_path, proj_path, 'polygons/SR_pops.rda')
load(spatial_files) ; rm(fall_pop)

spsm_pop <- spsm_pop %>%
  filter(!grepl('NC', TRT_POPID)) %>%
  mutate(pop = str_trim(str_remove(POP_NAME, " above.*|below.*"))) %>%  #remove everything after
  #extract = str_trim(str_extract(POP_NAME, ".*(?= above|below)"))) %>% # extract everything before
  mutate(pop = case_when(
    TRT_POPID == 'MFLMA' ~ 'Middle Fork Salmon River Lower Mainstem',
    TRT_POPID == 'MFUMA' ~ 'Middle Fork Salmon River Upper Mainstem',
    TRT_POPID == 'GRLOS' ~ 'Wallowa/Lostine Rivers',
    TRT_POPID == 'SFSMA' ~ 'South Fork Salmon River',
    TRUE ~ pop
  )) %>%
  mutate(pop = str_to_title(pop)) %>%
  select(mpg = MPG, pop, TRT_POPID)

spsm_esu_dps <- sf::st_read(paste0(user_path, proj_path,'polygons/CHNK_SPSU_ALL/CHNK_SPSU_All.shp'), quiet = TRUE) %>%
    filter(grepl('Snake', ESU_DPS)) %>%
    mutate(extant = case_when(
      grepl('Outside', ESU_DPS) ~ 'Extinct',
      grepl('North Fork Clearwater', NWR_NAME) ~ 'Extinct',
      TRUE ~ 'Extant')
    ) %>%
    group_by(extant) %>%
    summarize(shape_area = sum(SHAPE_AREA)) %>%
    st_transform(crs = 4326)

sth_pop <- sth_pop %>%
    filter(!grepl('NFC', TRT_POPID))

sth_esu_dps <- sf::st_read(paste0(user_path, proj_path,'polygons/STHD_SUWI_ALL/STHD_SUWI_All.shp'), quiet = TRUE) %>%
    filter(grepl('Snake', ESU_DPS)) %>%
    mutate(extant = case_when(
      grepl('Outside', ESU_DPS) ~ 'Extinct',
      grepl('North Fork Clearwater', NWR_NAME) ~ 'Extinct',
      TRUE ~ 'Extant')
    ) %>%
    group_by(extant) %>%
    summarize(shape_area = sum(SHAPE_AREA)) %>%
    st_transform(crs = 4326)

pnw <- st_as_sf(map("state", plot = FALSE, fill = TRUE)) %>% filter(ID %in% c('idaho', 'oregon', 'washington')) %>%
  st_transform(crs = 4326)

```


```{r esu-map, fig.cap = 'Currently accessible and extant spring-summer Chinook Salmon (A) and steelhead (B) populations within the Snake River Basin evolutionary significant unit (ESU) or distinct population segment (DPS) are grouped in similar colors while the grey shape indicates extict populations.'}
spsm_map <- ggplot() +
  geom_sf(data = spsm_esu_dps, fill = 'grey80') +
  geom_sf(data = spsm_pop, aes(fill = mpg),
          colour = 'black', size = 1, inherit.aes = FALSE) +
  # ggrepel::geom_label_repel(
  #   data = spsm_pop,
  #   aes(label = TRT_POPID, geometry = geometry),
  #   size = 2,
  #   stat = "sf_coordinates",
  #   min.segment.length = 0,
  #   inherit.aes = FALSE,
  #   show.legend = FALSE
  # ) +
  guides(fill = guide_legend(ncol = 2)) +
  scale_fill_brewer(palette = 'Dark2') +
  labs(fill = '') +
  theme_void() +
  theme(legend.position = 'bottom',
        legend.text = element_text(size = 6))


sth_map <- ggplot() +
  geom_sf(data = sth_esu_dps, fill = 'grey80') +
  geom_sf(data = sth_pop, aes(fill = MPG),
          colour = 'black', size = 1, inherit.aes = FALSE) +
  # ggrepel::geom_label_repel(
  #   data = sth_pop,
  #   aes(label = TRT_POPID, geometry = geometry),
  #   size = 2,
  #   stat = "sf_coordinates",
  #   min.segment.length = 0,
  #   inherit.aes = FALSE,
  #   show.legend = FALSE
  # ) +
  guides(fill = guide_legend(ncol = 2)) +
  scale_fill_brewer(palette = 'Dark2') +
  labs(fill = '') +
  theme_void() +
  theme(legend.position = 'bottom',
        legend.text = element_text(size = 6))

inset <- ggplot() +
  geom_sf(data = pnw) +
  geom_sf(data = sth_esu_dps, fill = 'grey80') +
  geom_sf(data = sth_pop, fill = 'grey25', color = NA) +
  theme_nothing()

map_fig <- cowplot::plot_grid(spsm_map, sth_map, labels = c('A', 'B'), label_size = 12)

map_final <- cowplot::ggdraw(map_fig) +
  cowplot::draw_plot(inset,
            x = .85,
            y = .8,
            width = .15,
            height = .2)

map_final
```

# Methods

## Data

<!-- This study seeks to use the best available abundance information to understand the current status of Snake River populations. We begin by modeling spawner abundance using two independent sources of information, when available, for each population with a dynamic linear model to account for observation and process error. The model seeks to describe the unknown state process for each population while allowing and statistically correcting for imperfect observations. Next, we fit a linear regression (i.e., trend line) to each state process for the last 10-year period to describe contemporary trends and the last two generations of returns. Last, we extend the trend lines five years into the future to identify populations at highest risk of reaching quasi-extinction.    -->

This study seeks to use the best available abundance estimates of natural-origin fish returning to accessible populations within the Snake River Basin. We begin with two independent time-series of abundance estimates generated from different data collection methods and analyses completed by biologists at the Idaho Department of Fish Game, Washington Department of Fish and Game, Oregon Department of Fish and Game, and Nez Perce Tribe. We obtained both time-series from [StreamNet's Coordinated Assessments](https://cax.streamnet.org) natural-origin spawner abundance (NOSA) dataset (Tables \@ref(tab:chn-obs) and \@ref(tab:sth-obs)). Both datasets were first subset the to include only records from Snake River Basin ESU/DPS populations, and to begin in 1980 for sp/su Chinook Salmon and 2010 for steelhead. The time period for sp/su Chinook Salmon was selected in order to only include returns years post Lower Granite Dam construction to better represent contemporary returns. The steelhead dataset begins later and aligns with the majority of steelhead data collection efforts across the Snake Basin.  

The first time-series of abundance estimates were primarily derived from observations of redds and fish sampled at weirs, and intended to represent NOSA including age-3 jacks (NOSAij). In general, redd data was expanded into spawner abundance values using sex ratios estimated from carcasses and assumed fish-per-redd values (e.g., **need citation...Hassemer??**), or mark-recapture studies using fish collected at weirs (e.g., **need citations**).Specifc details regarding the estimation of NOSAij for each population can be found in agency reports [**need citations**] or by contacting the contributing source listed in Coordinated Assessments metadata. 

The second time-series represents escapement of natural-origin fish (including age-3 jacks) returning to the population. Population escapement estimates were derived from the STate-space Adult Dam Escapement Model (STADEM) [@see_state-space_2021] and the Dam Adult Branch Occupancy Model (DABOM) [@waterhouse_bayesian_2020; @see_pit_2016; @kinzer_snake_2020]. STADEM estimates natural and hatchery origin escapement of fish passing Lower Granite Dam. DABOM estimates time-varying transition probabilities to Snake River populations with randomly marked fish trapped at Lower Granite Dam while accounting for 1) differential adult run timings among populations and 2) potentially inconsistent trapping and tagging rates. The product of the two models equal population escapement estimates. 

<!-- Abundance trends for individual sp/su Chinook Salmon and steelhead populations were analyzed using data from StreamNet's Coordinated Assessments [database](https://cax.streamnet.org) and passive integrated transponder (PIT) tag model results. For most combinations of return years and sp/su Chinook Salmon populations, data originated from the Coordinated Assessments database and were produced by the state or tribal co-managers responsible for monitoring those populations. The dataset was retrieved from Coordinated Assessments on January X, 2025, and filtered to only include Snake River sp/su Chinook Salmon and steelhead populations with natural-origin spawner abundance estimates, including jacks (NOSAij). For many Snake River populations, multiple NOSAij estimates were available for the same year due to variations in estimation methods (e.g., spawning ground surveys, mark-recapture) and/or data generators. In these cases, we selected annual estimates labeled as the method used by the National Oceanic and Atmospheric Administration (NOAA) technical recovery team. Steelhead abundance data were filtered from Coordinated Assessments by selecting estimates generated through the STate-space Adult Dam Escapement Model (STADEM) [@see_state-space_2021] and the Dam Adult Branch Occupancy Model (DABOM) [@see_pit_2016; @kinzer_snake_2020], as indicated in the "Comments" field. Population data for sp/su Chinook Salmon returning to Big Sheep Creek, Lookingglass Creek, Little Salmon River, and Panther Creek were unavailable in the Coordinated Assessments database. For these populations, we included estimates derived from the STADEM and DABOM models but obtained from @kinzerSnakeRiverBasin2020. -->

<!--
### ESU/DPS Aggregated Abundance and Status
We derived natural-origin steelhead abundance at LGD from daily window count data queried from DART . The daily count data was originally collected by the U.S. Army Corps of Engineers (USACE), and represents only those fish passing the window during daytime operational hours. During daytime operations fish passage counts occurred for 50 minutes of each hour. The USACE then derived the daily window count by summing hourly counts for each day, and expanding counts by 1.2 to account for the missing 10 minute period. We calculated annual spawn year estimates of natural-origin steelhead passing LGD by summing all daily counts between July 1st and June 30th.  
-->

<!-- The Idaho Department of Fish and Game (IDFG) provided abundance estimates of adult natural-origin spring/summer (sp/su) Chinook Salmon and natural-origin steelhead returning to the Snake River, which were used in the aggregated trend analyses. Data from 1962â€“1997 originated from an unpublished internal IDFG dataset (Timothy Copeland, pers. comm.). Data for return years 1998â€“2024 were published in IDFG annual reports [@camachoWildAdultSteelhead2019; @lawryWildAdultSteelhead2020a] **(Update)**. For each year in the dataset, natural-origin adult abundance constituted a subset of the total spring/summer (sp/su) Chinook Salmon passing the furthest upstream completed dam on the lower Snake River. Total fish counts were recorded as individuals ascended the fish ladder and passed a viewing window (USACE report). These total counts were then partitioned into natural-origin and hatchery-origin components, as well as adult and jack groups. The methods used to apportion the 1998â€“2024 returns into these components varied by year. Generally, this process relied on genetic and scale analyses of fish samples collected at Lower Granite Dam, combined with origin proportions calculated from spawning ground survey data [@camachoWildAdultSteelhead2019; @lawryWildAdultSteelhead2020a]. However, the methods used to differentiate adult, jack, and origin groups for return years prior to 1998 remain unknown. -->



```{r load-mod_fits}
# load model fits
load(paste0('../data/output/', 'Chinook_salmon', '_model_fits_',yr,'.rda'))
chn_mod_inputs <- mod_inputs
chn_mod_fit <- mod_fit[-c(3:6)] # remove duplicate model runs

load(paste0('../data/output/', 'Chinook_salmon', '_best_fit_',yr,'.rda'))
chn_best_fit <- best_mod_fits

# load model fits
load(paste0('../data/output/', 'Steelhead', '_model_fits_',yr,'.rda'))
sth_mod_inputs <- mod_inputs
sth_mod_fit <- mod_fit[-c(3:6)]

load(paste0('../data/output/', 'Steelhead', '_best_fit_',yr,'.rda'))
sth_best_fit <- best_mod_fits

rm(mod_inputs, mod_fit, best_mod_fits)
```


```{r chn-obs, tab.cap="Summary of abundance time-series used in modeling Snake River spring/summer Chinook Salmon populations (n = 48). Time-series length and data sources varied by population, with observations spanning from 1980 to 2024. Abundance estimates were primarily based on spawning ground surveys and weir counts, with PIT-tag detections included for select populations. The 10th, 50th (median), and 90th percentiles of observed abundance values are provided to summarize distributional characteristics across years."}
chn_mod_inputs$dat %>%
  filter(!is.na(nosaij)) %>%
  filter(spawningyear >= 1980) %>%
  group_by(mpg, pop, method) %>%
  summarise(obs_year = paste0(min(spawningyear),'-',max(spawningyear)),
            n = n(),
            p_10 = quantile(nosaij, probs = .10),
            p_50 = quantile(nosaij, probs =  .50),
            p_90 = quantile(nosaij, probs =  .90)
            #min_nosaij = min(nosaij),
            #max_nosaij = max(nosaij),
            #avg_nosaij = mean(nosaij),
            #sd_nosaij = sd(nosaij)
            ) %>%
  mutate(method = case_when(
    method == 2 ~ 'PIT-tag',
    method == 1 ~ 'SGS and Weir')
  ) %>%
  arrange(mpg, pop) %>%
  kable(
    col.names = c('MPG', 'Population', 'Method', 'Years', '# Years', '10%', '50%', '90%'),
    booktabs = TRUE,
    digits = 0,
    #label = NA,
    format = 'latex'
  ) %>%
  collapse_rows(columns = 1:2, valign = "top", latex_hline = "none") %>%
  kable_styling(font_size = 8)
```


```{r sth-obs, tab.cap="Summary of abundance time-series used in modeling Snake River summer steelhead populations (n = 25). Time-series length and data sources varied by population, with observations spanning from 2010 to 2024. Abundance estimates were primarily based on PIT-tag detections, with spawning ground surveys and weir counts included for select populations. The 10th, 50th (median), and 90th percentiles of observed abundance values are provided to summarize distributional characteristics across years."}
sth_mod_inputs$dat %>%
  filter(!is.na(nosaij)) %>%
  filter(spawningyear >= 2010) %>%
  group_by(mpg, pop, method) %>%
  summarise(obs_year = paste0(min(spawningyear),'-',max(spawningyear)),
            n = n(),
            p_10 = quantile(nosaij, probs = .10),
            p_50 = quantile(nosaij, probs =  .50),
            p_90 = quantile(nosaij, probs =  .90)
            #min_nosaij = min(nosaij),
            #max_nosaij = max(nosaij),
            #avg_nosaij = mean(nosaij),
            #sd_nosaij = sd(nosaij)
            ) %>%
  mutate(method = case_when(
    method == 2 ~ 'PIT-tag',
    method == 1 ~ 'SGS and Weir')
  ) %>%
  arrange(mpg, pop) %>%
  kable(
    col.names = c('MPG', 'Population', 'Method', 'Years', '# Years', '10%', '50%', '90%'),
    booktabs = TRUE,
    digits = 0,
    #label = NA,
    format = 'latex'
  ) %>%
  collapse_rows(columns = 1:2, valign = "top", latex_hline = "none") %>%
  kable_styling(font_size = 8)
```

[Figure of stochasiticity across time, and the synchronization after 1980.]



## Abundance Patterns

<!-- Methe et al. 2021 - A guide to state-space modeling of ecological time series-->

<!-- Methe et al. 2021 and Holmes et al. 2012 suggest AICb for model selection of state-space models. -->

In each case, the time-series abundance data are not the exact truth, and in many cases, they are reported without levels of certainty (i.e., precision estimates) or measurement error. Reported estimates instead are generally the result of incomplete observations (i.e., spatial and temporal coverage is incomplete) and the product of combining information from multiple data collection activities and fish metrics together (i.e., redd count surveys, mark/recapture events, carcass collections), with each item having the possibility of being incorrect or biasing the abundance estimate from the unknown truth [@auger-methe_guide_2021]. To better understand the true unknown abundance and underlying trends contained within the data we removed measurement error using a multivariate dynamic linear model (DLM) [@zuur_estimating_2003]. A DLM is a time series model constructed as a type of state-space model that separates observation and state processes, and assumes the processes change dynamically following linear models [@royle_hierarchical_2008]. Dynamic linear models are capable of capturing the serial correlation in the data and can share covariance across multiple time-series, thus, effectively allowing information to be shared from data rich populations with long time-series, to data poor populations with short datasets or missing years [@auger-methe_guide_2021; @holmes_marss_2012]. Although DLMs can handle some missing data, we conservatively chose to only include time-series with five or more years of abundances to reduce potential risks of parameter bias and overfitting. 

The unobserved state process model follows the linear equation,

$$
x_t = x_{t-1} + u + w_t; \\
w_t \sim MVN(0,\mathbf{Q})
$$
where, $x_t$ is an $m \space X \space 1$ matrix of true unknown states for return year $t$. Parameter $u$ is $m \space X \space 1$ and represents drift between subsequent return years for each state $m$. Process error ($w_t$) is assumed multivariate normal with mean zero and the $m \space X \space m$ variance-covariance matrix $\bf{Q}$.

The observation model is represented as,

$$
y_t = \mathbf{Z}x_t + a + v_t; \\
v_t \sim MVN(0,\mathbf{R})
$$
where, $y_t$ is an $n \space X \space 1$ matrix of natural-log transformed observed abundance at return year $t$ for $n$ independent time-series. Return year abundances for each $n$ and $t$ observation is mapped to the unknown state ($x_t$) with the $n \space X \space m$ matrix $\bf{Z}$. Parameter $a$ is $n \space X \space 1$ and provides a y-intercept scaling (i.e., bias correction) for the $m^{th}$ state and each $n^{th}$ time-series. Observational error ($v_t$) is modeled as multivariate normal with mean zero and the $n \space X \space n$ variance-covariance matrix $\bf{R}$.

We modeled four different scenarios to represent true unknown states for sp/su Chinook Salmon and steelhead populations. The scenarios included an individual state for each of the $n$ time-series, states for each of the populations, states for each of the major population groups (MPGs), and a single state for the entire Snake River Basin. Parameters $u$ and $a$ were set to unequal across the modeled states and time-series mapped to each state.

We modeled three different variance-covariance matrices for process error and two variance-covariance matrices of observation error for each of the four state scenarios. The process error matrix ($\bf{Q}$) was assumed to eithr have equal variance and covariance terms for each state, or no covariance and equal or unequal variances on the matrix diagonal. The observation error matrix ($\bf{R}$) was assumed to have either equal or unequal variance on the diagonal, while off diagonal covariance terms were equal to zero.

The different combinations resulted in 14 model runs fit with the MARSS package [@holmes_marss_2012] and the statistical programming language R [@R-base]. The best model was selected as having the lowest AICc value of all successful (i.e., converged) model runs [@holmes_marss_2012; @R-MARSS]. Residuals from selected models were examined visually for assumption violations of heterogeneity and normality. All models were fit using the statistical software R [@R-base] and the MARSS package [@holmes_marss_2012; @R-MARSS].
 
## Recent 10-year Trends

To evaluate recent population trajectories, we calculated a 10-year trend for each population, representing the most recent two generations of returns. Limiting the analysis to the past decade allowed us to focus on population responses to recent environmental conditions while retaining sufficient interannual variability in abundance.

For each population, the trend was estimated from the state process ($x_t$), produced by the best fitting DLM, to which the population was assigned. The trend was calculated as the slope of a linear regression of the estimated natural-log-transformed abundance ($x_t$) on year. The slope represents the average annual rate of change in abundance over the past 10 years.

## Population Status

We assessed current and projected population status by evaluating the proportion of populations above or below abundance evaluation points (e.g., "healthy and harvestable", minimum viable threshold, or QET). A population was considered below the QET if its estimated abundance from the DLM fell below 50 in each of the last four years of observation (2021-2024). The proportion was calculated as the number of populations within each abundance criterion divided by the total number of populations included in the DLM analysis.

Future population status was assessed using 5-year forecasts using the slope parameter from the linear regression models described above. A population was classified as falling below the QET if any single year within the forecast period was predicted to be below 50 spawners, under the assumption that all subsequent values would remain below the threshold due to the linear nature of the model.

# Results

## Abundance Patterns

The best fitting model for sp/su Chinook Salmon included separate state processes for each major population group (Table \@ref(tab:chn-mod-results)), whereas, summer steelhead was best represented by a single basin-wide process (Table \@ref(tab:sth-mod-results)). For both species, the difference in AICc values between the top two models exceeded 10.00, a threshold commonly interpreted to indicate the second ranked model has little to no support as compared to the first ranked model [@burnham_multimodel_2004]. For sp/su Chinook Salmon, the process error matrix included two parameters: one for an equal variance and the other for an equal covariance across the seven MPG processes. In contrast, the best fitting model for summer steelhead included only a single basin-wide process, as such, process error consisted of a single variance parameter. Observational error for both species was best modeled with unique variance parameters for each time-series.   

We evaluated model assumptions by visually examining residual plots for patterns indicating autocorrelation, non-normality, or heteroscedasticity. Overall, these diagnostic checks supported the adequacy of the model structure and parameter estimates (Figures \@ref(fig:chn-resids) and \@ref(fig:sth-resids)). However, in a few populations residuals did show evidence of serial correlation and any future models may benefit from additional terms. Model convergence was confirmed with the MARSS package output indicating the optimization algorithm reached a stable peak in the likelihood [@holmes_2021].

```{r chn-mod-results, tab.cap = "Candidate dynamic linear models fitted to 48 spring/summer Chinook Salmon abundance time-series to evaluate population dynamics and identify models best explaining Snake River trends. The number of state processes estimated in each model is indicated in column U. Unique state process error parameters are denoted in column Q, and observation error parameters in column R. Model fit is summarized using log-likelihood (logLik), corrected Akaike Information Criterion (AICc), and relative model support ($\\Delta$AIC)."}
# summarize model results and select best model
chn_mod_results <- summarize_ModelFits(mod_fit = chn_mod_fit)

chn_mod_results %>%
  #slice(1:10) %>%
  select(model_id, U, Q, R, logLik, AICc, deltaAIC) %>%
  kable(col.names = c('Model Id', 'U', 'Q', 'R', 'logLik', 'AICc', '$\\Delta$AIC'),
        booktabs = TRUE, 
        digits = 2,
        escape = FALSE,
        label = NA,
        latex = TRUE)
# %>%
#   kable_classic(full_width =T)
```


```{r shd-mod-results, tab.cap = "Candidate dynamic linear models fitted to 25 summer steelhead abundance time-series to evaluate population dynamics and identify models best explaining Snake River trends. The number of state processes estimated in each model is indicated in column U. Unique state process error parameters are denoted in column Q, and observation error parameters in column R. Model fit is summarized using log-likelihood (logLik), corrected Akaike Information Criterion (AICc), and relative model support ($\\Delta$AIC)."}
sth_mod_results <- summarize_ModelFits(sth_mod_fit)

sth_mod_results %>%
  #slice(1:10) %>%
  select(model_id, U, Q, R, logLik, AICc, deltaAIC) %>%
  kable(col.names = c('Model Id', 'u', 'Q', 'R', 'logLik', 'AICc', '$\\Delta$AIC'),
        booktabs = TRUE,
        escape = FALSE,
        label = NA,
        latex = TRUE)
# %>%
#   kable_classic(full_width = TRUE)
```


```{r best-mod-fits, eval = TRUE}
chn_best_model <- chn_mod_fit[[chn_mod_results$model_id[which.min(chn_mod_results$AICc)]]]
sth_best_model <- sth_mod_fit[[sth_mod_results$model_id[which.min(sth_mod_results$AICc)]]]
```


```{r mod-u, eval = TRUE}
drift_df <- bind_rows(
  tibble(`.rownames` = rownames(chn_best_model$par$U),
         x0 = chn_best_model$par$x0[,1],
         u = chn_best_model$par$U[,1]) %>%
    mutate(spp = 'Chinook Salmon'),
  tibble(.rownames = 'Snake Basin',
         x0 = sth_best_model$par$x0[,1],
         u = sth_best_model$par$U[,1]) %>%
    mutate(spp = 'Steelhead')
) %>%
  mutate(drift = exp(u),
         growth = (drift - 1) * 100)
```

The estimated annual percent change in abundance over the full time series ($u$), calculated as $(e^u - 1) \times 100$, ranged from `r round(min(drift_df$growth),2)`\% and `r round(max(drift_df$growth),2)`\% for spring-summer Chinook Salmon (1980-2024) and summer steelhead (2010-2024; Figures \@ref(fig:chn-state) and \@ref(fig:sth-state)). Among the Chinook Salmon populations, those within the Lower Snake major population group (i.e., Asotin Creek and Tucannon River) exhibited the fastest rate of decline, with an estimated annual decrease of -5.8\%. In contrast, the highest positive growth was observed in populations from the South Fork Salmon River major population group. Summer steelhead had the steepest overall decline, with an estimated annual growth rate of `r round(drift_df$growth[drift_df$spp == 'Steelhead'],2)`\%.

```{r chn-state, out.width='100%', eval = TRUE, fig.cap = "Estimated abundance (natural-log) trends for the seven state processes (xtT) estimated from the best fitting Snake River spring/summer Chinook Salmon model (grey shading represents 95% CI's). The abundance trend for each process across the full time-series is shown by the dashed line and generated from the estimated u and x0 parameters."}
include_graphics(paste0(fig_path,'Chinook_salmon/Chinook_salmon_states_',yr,'.png'))

# autoplot(chn_best_model, plot.type = 'xtT') +
#   geom_abline(data = drift_df[drift_df$spp != 'Steelhead',], aes(intercept = x0, slope = u), size = 1, linetype = 1, colour = 'blue') +
#   geom_text(data = drift_df[drift_df$spp != 'Steelhead',], aes(x = 6, y = -Inf, label = paste0("x0 = ", round(x0,2))), vjust = -1.5) +
#   geom_text(data = drift_df[drift_df$spp != 'Steelhead',], aes(x = 6, y = -Inf, label = paste0("u = ", round(u,2))), vjust = -.5) +
#   scale_x_continuous(labels = seq(1980, yr, 10), breaks = seq(1, 45, 10)) +
#   #scale_y_continuous(limits = c(-1,10)) +
#   facet_wrap(~.rownames) +
#   theme_rk() +
#   labs(x = 'Spawn Year',
#        y = 'LN(Abundance)',
#        title = '',
#        caption = '')
```

```{r sth-state, out.width = '100%', eval = TRUE, fig.cap = "Estimated abundance (natural-log) trend for a single state process (xtT) as estimated from the best fitting Snake River summer steelhed model (grey shading represents 95% CI's). The abundance trend for each process across the full time-series is shown by the dashed line and generated from the estimated u and x0 parameters."}
include_graphics(paste0(fig_path,'Steelhead/Steelhead_states_',yr,'.png'))

# autoplot(sth_best_model, plot.type = 'xtT') +
#   geom_abline(data = drift_df[drift_df$spp == 'Steelhead',], aes(intercept = x0, slope = u), size = 1, linetype = 1, colour = 'blue') +
#   geom_text(data = drift_df[drift_df$spp == 'Steelhead',], aes(x = 2, y = -Inf, label = paste0("x0 = ", round(x0,2))), vjust = -1.5) +
#   geom_text(data = drift_df[drift_df$spp == 'Steelhead',], aes(x = 2, y = -Inf, label = paste0("u = ", round(u,2))), vjust = -.5) +
#   scale_x_continuous(labels = seq(2010, yr, 3), breaks = seq(1, 15, 3)) +
#   scale_y_continuous(limits = c(4,8)) +
#   facet_wrap(~.rownames) +
#   theme_rk() +
#   labs(x = 'Spawn Year',
#        y = 'LN(Abundance)',
#        title = '',
#        caption = '')
```


## Recent 10-year Trends

After fitting a linear regression line to the last 10-years of estimated state processes we found summer steelhead has decreased annually by 11\% and six spring-summer Chinook Salmon major population groups also decreased (Figures \@ref(fig:chn-sa-slope) and \@ref(fig:sth-sa-slope)). Again, the Chinook Salmon South Fork Salmon River major population group had the highest, and only positive, rate of growth at 5.13\% annually. The remaining six major population groups in the last 10 years have decreased at annual rates of 5\% and higher, with the most severe decrease being 13\% in the Lower Snake populations.

```{r chn-sa-slope, out.width = '100%', eval = TRUE, fig.cap = 'Estimated slope parameters for natural-origin Snake River spring/summer Chinook Salmon abundance trends indicate an average annual decline of 6% for the last 10-years.'}
include_graphics(paste0(fig_path,'Chinook_salmon/Chinook_salmon_slope_',yr,'.png'))
```


```{r sth-sa-slope, out.width = '100%', eval = TRUE, fig.cap = 'Modeled abundance trends of natural-origin Snake River summer steelhead indicate an annual 11% decline for the last 10-years.'}
include_graphics(paste0(fig_path,'Steelhead/Steelhead_slope_',yr,'.png'))
```


## Population Status

```{r targets}
mgt_targets <- readxl::read_excel('../data/input/mgt_targets.xlsx',
                                  sheet = 'pop_targets')
chn_fits <- chn_best_fit %>%
  filter(spawningyear >= 1980) %>%
  arrange(pop, spawningyear, desc(method)) %>%
  group_by(pop, spawningyear) %>%
  slice(1) %>%
  summarise(exp_fit = exp(.fitted)) %>%
  left_join(mgt_targets %>%
              filter(grepl('Spring/summer', run)) %>%
              select(pop, CBP_goals, target) %>%
              pivot_wider(names_from = CBP_goals, values_from = target),
            by = 'pop') %>%
  mutate(h = ifelse(exp_fit >= High, T, F),
         l = ifelse(exp_fit >= Low, T, F),
         q = ifelse(exp_fit <= Critical, T, F))

chn_stats <- chn_fits %>%
  ungroup() %>%
  #group_by(pop) %>%
  summarise(n = n(),
            h = sum(h),
            l = sum(l),
            q = sum(q))

chn_avg <- chn_fits %>%
  filter(spawningyear > (2024-4)) %>%
  group_by(pop) %>%
  summarise(n = n(),
            avg = mean(exp_fit),
            p_MAT = avg/min(Low)) %>%
  ungroup()

sth_fits <- sth_best_fit %>%
  filter(spawningyear >= 2010) %>%
  arrange(pop, spawningyear, desc(method)) %>%
  group_by(pop, spawningyear) %>%
  slice(1) %>%
  summarise(exp_fit = exp(.fitted)) %>%
  left_join(mgt_targets %>%
              filter(grepl('Summer', run)) %>%
              select(pop, CBP_goals, target) %>%
              pivot_wider(names_from = CBP_goals, values_from = target),
            by = 'pop') %>%
  mutate(h = ifelse(exp_fit >= High, T, F),
         l = ifelse(exp_fit >= Low, T, F),
         q = ifelse(exp_fit <= Critical, T, F))

sth_stats <- sth_fits %>%
  ungroup() %>%
  #group_by(pop) %>%
  summarise(n = n(),
            h = sum(h),
            l = sum(l),
            q = sum(q))

sth_avg <- sth_fits %>%
  filter(spawningyear > (2024-4)) %>%
  group_by(pop) %>%
  summarise(n = n(),
            avg = mean(exp_fit),
            p_MAT = avg/min(Low)) %>%
  ungroup()
```


Over the last `r n_distinct(chn_fits$spawningyear)` return years included in the sp/su Chinook Salmon analysis most abundances have been below critical levels. Of the `r prettyNum(chn_stats$n)` combinations of populations and return years, `r chn_stats$h` of the returns have been at "healthy and harvestable levels", and only `r chn_stats$l` (`r round(chn_stats$l/chn_stats$n,2)*100`\%) have been above minimum abundance thresholds, while `r chn_stats$q` (`r round(chn_stats$q/chn_stats$n,2)*100`\%) have been below 50 annual spawners (Figure \@ref(fig:chn-targets)). 

The mean return of the last four years of sp/su Chinook Salmon population abundances only account for an average of `r round(mean(chn_avg$p_MAT),2)*100`\% of MAT across all populations. Four populations of sp/su Chinook Salmon currently meet the requirements of quasi-extinction (i.e., four consecutive years below 50 spawners) and an additional 8 populations were below 50 in 2024. While another 2 are predicted to drop below 50 by 2029, ultimately resulting in 41\% of the analyzed sp/su Chinook Salmon populations being predicted to reach quasi-extinction within the next 5 years (Figure \@ref(fig:chn-qet-map)). 

<!-- - Seven state processes and trends, aligned with major population groups, represent spring/summer Chinook Salmon populations -->
<!-- - Spring/summer Chinook Salmon populations have declined by an average of 6% annually for the last 10-years -->
<!-- - All populations below critical abundance thresholds -->
<!--   - 4 populations currently below the QET50 -->
<!--   - 8 populations below 50 in 2024 -->
<!--   - 2 populations predicted to fall below 50 by 2029 -->
<!--   - 20 populations remain above 50 in 2029 -->


```{r chn-qet-map, out.width = '100%', eval = TRUE, fig.cap = 'Current status of natural-origin Snake River spring/summer Chinook Salmon relative to the quasi-extinction threshold (QET) and Columbia Basin Partnership goals.'}
include_graphics(paste0(fig_path,'Chinook_salmon/','Chinook_salmon_map_',yr,'.png'))
```

Across the last `r n_distinct(sth_fits$spawningyear)` return years included in the analysis, steelhead abundances have also remained low relative to goals. Out of `r sth_stats$n` total population-year combinations, `r sth_stats$h` were at "healthy and harvestable" levels, `r sth_stats$l` exceeded the minimum abundance thresholds, and `r sth_stats$q` (`r round(sth_stats$q/sth_stats$n, 2)*100`\%) of all records were at critical abundance levels (Figure \@ref(fig:sth-targets)).

The average steelhead abundance over the most recent four year period has a mean return representing just `r round(mean(sth_avg$p_MAT), 2)*100`\% of the minimum abundance threshold across all populations. Currently, three steelhead populations meet the QET criteria, and an additional three populations are projected to fall below this threshold by 2029. In total, 27\% of the analyzed steelhead populations are expected to reach quasi-extinction within the next five years (Figure \@ref(fig:sth-qet-map)).

<!-- - A single state process and trend represents all summer steelhead populations -->
<!-- - Summer steelhead have declined by 11% annually for the last 10-years -->
<!-- - All populations below critical abundance thresholds -->
<!--   - 3 populations currently below the QET50 -->
<!--   - 3 populations predicted to fall below 50 by 2029 -->
<!--   - 16 populations remain above 50 in 2029 -->


```{r sth-qet-map, out.width = '100%', eval = TRUE, fig.cap = 'Current status of natural-origin Snake River summer steelhead relative to the quasi-extinction threshold (QET) and Columbia Basin Partnership goals.'}
include_graphics(paste0(fig_path,'Steelhead/Steelhead_map_',yr,'.png'))
```

# Discussion

Despite over three decades of recovery actions since the ESA listing of Snake River sp/su Chinook Salmon and steelhead, our results show that most extant populations remain well below viable abundance thresholds and far from healthy or harvestable levels. Notably, seven populationsâ€”four Chinook and three steelheadâ€”currently meet the quasi-extinction threshold (QET) of 50 or fewer spawners for the past four consecutive years. If current 10-year trends persist, an additional 13 populations are projected to fall below the QET within five years. These findings are particularly concerning given the magnitude of recovery investments, including hydrosystem passage improvements, large-scale habitat restoration, and hatchery supplementation programs. In contrast to the intended outcomes, Snake River populations appear to have lost ground in the fight against extinction.

Over the last 10 years, sp/su Chinook Salmon and steelhead abundances have declined more sharply than in prior decades. Abundance estimates suggests that the most recent downward trend in both species began in 2010. These patterns are consistent with research showing strong correlations between salmon returns and oceanographic conditions such as the Pacific Decadal Oscillation and sea surface temperatures [@mantua_pacific_1997; @crozier_climate_2021]. As ocean conditions continue to warm, further declines are likely without substantial changes to freshwater conditions.

While both species have shown some variability in annual returns, long-term averages remain below recovery targets. Since ESA listing, sp/su Chinook Salmon populations have exceeded the minimum abundance threshold only in 8% of the return years, and recent returns have hovered near QET levels. Steelhead populations have exceeded MAT more frequently but remain far from delisting thresholds or Columbia Basin Partnership goals for healthy and harvestable populations.

We replicated and slightly modified @ford_biological_2022 modeling framework to estimate underlying population dynamics to assess and update Snake River anadromous population trends. We chose a 10-year evaluation window, starting in 2015, to capture the more recent and steeper declines visible in both sp/su Chinook Salmon and steelhead abundance. Unlike @ford_biological_2022 15-year trend approach, which we believe may have masked current declines due to low starting and ending points (i.e., a less steep slope), our analysis focused on the more immediate trajectory of population change, providing a more sobering and urgent picture of current status.

Indeed, we found nearly all sp/su Chinook Salmon populations had declined from 2015-2024â€”a 6\% average annual decrease. Steelhead populations declined slightly faster at an annual rate 18\%. Four (12\%) of the sp/su Chinook Salmon populations are already below the quasi-extinction threshold, and 14 (41\%) are projected to be quasi-extinct within five years. Fewer steelhead populations (3, or 14\%) are currently at the quasi-extinct level, but projections indicate that 6 (27\%) will reach this threshold within five years.

These results suggest that Snake River anadromous fish populations are responding similarly to broad-scale environmental drivers rather than localized habitat conditions. This aligns with previous findings that populations within major population groups are often exposed to similar migration barriers, ocean conditions, and management actions [@copeland_how_2024]. The fitted models showed population time series have mostly decreased since the beginning of the datasets, with recent declines driving projected quasi-extinction risk. Notably, the Lower Snake and Wet Clearwater major population groups for sp/su Chinook Salmonâ€”areas of lower elevation and more degraded habitatâ€”showed the fastest rates of decline.

The predictive models used here assume the recent 10-year trend continues linearly. While this simplification ignores serial correlation and potential reversals due to cyclic conditions (e.g., improved ocean years), it effectively highlights the long-term trajectory under a "status quo" scenario. For instance, the higher-than-expected returns observed in 2021 and 2022 likely reflect short-term improvements in ocean conditions and do not alter the long-term trend of decline. Importantly, even these higher returns remain well below the thresholds necessary for delisting or for reaching recovery goals.

## Conclusions and Implications

Since ESA listing, billions of dollars have been invested in recovery, yet Snake River Chinook and steelhead populations have failed to rebound. While localized benefits from habitat projects and passage improvements have been observed, they have not altered basinwide trends. Our analysis confirms that most populations are either below or approaching extinction thresholds, and the underlying causesâ€”particularly ocean survival and hydrosystem-related mortalityâ€”remain largely unaddressed.

Looking ahead, climate change poses an even greater challenge. Warmer ocean conditions and reduced snowpack are expected to reduce freshwater flows, increase stream temperatures, and exacerbate mortality throughout the fishes' life cycle [@crozier_climate_2019; @crozier_climate_2021]. Given these pressures, even more aggressive actions may be necessary to avoid extinction. This includes both structural changes (e.g., breaching Lower Snake River dams to improve passage and habitat) and conservation interventions (e.g., temporary supplementation, captive broodstocks, or revised harvest policies) to prevent the loss of populations before long-term solutions can take effect.

In summary, our analysis provides a scientifically grounded, transparent evaluation of the current and projected status of Snake River anadromous fish. While short-term variability will persist, the long-term trend is unmistakable: these populations are declining. Without bold and transformative action, ESA recovery goals will remain out of reach, and the region may lose the opportunity to sustain wild salmon and steelhead for future generations.


<!--
# Extra Ideas

Despite over three decades of restoration efforts and the ESA-listing status Snake River sp/su Chinook Salmon and summer steelhead all of the extant populations are below healthy and harvestable levels and viable abundance thresholds. Seven populations (4 Chinook Salmon and 3 steelhead) are currently meeting quasi-extintion status of 50 or fewer spawners for the last 4 consecutive years. Another 13 extant populations are expected to fall below the QET within the next 5-years if the 10-year abundance trends continue. Since ESA-listing and the hundreds of millions of dollars spent on recovery Snake River sp/su Chinook Salmon and steelhead populations have only lost ground in their fight against extinction.

In recent years, sp/su Chinook Salmon and steelhead returns to the Snake River basin have decreased quickly and are expected to continue declining into the future. In the last 10 years, abundances at LGD ranged from 4,108 to 26,351 from 2011-2020 for sp/su Chinook Salmon, and steelhead ranged from 8,287 to 45,789. A moving average suggests potential declines in sp/su Chinook Salmon abundance began as early as 2010 (Figure), and around 2015 for steelhead (Figure ). @mantua_pacific_1997 and @crozier_climate_2021 have shown returning abundance is highly correlated with ocean metrics (e.g., pacific decadal oscillation and sea surface temperature), and as such, the recent decreases in abundance are expected given the additional stress of poor ocean conditions.

returning fish continuously fail in reaching abundance thresholds and goals. Sp/su Chinook Salmon returning to the Snake River have only exceeded the aggregated MAT (i.e., sum of population MAT) in three years post ESA listing, and in more recent years returns have been closer to the aggregated QET--similar to the levels observed in the mid-1990's (Figure ). Steelhead returns to the basin follow a similar annual abundance pattern, but have exceeded the aggregated MAT in more years and remain above the QET (Figure ). Neither species, however, has had abundances near aggregated healthy and harvestable goals set by the CBP at any point since the construction of LGD in 1975.


was to review the National Oceanic and Atmospheric Administration's Northwest Fisheries Science Center's draft Biological Status Report (dBSR; December 2020). To critically review their findings, we conducted similar analyses as those shared in the dBSR to better understand the current status and future direction of Snake River salmon and steelhead trends. After completing the initial review, we questioned how current and future population status related to QET, and if all populations were performing equally. To answer these new questions, our research included four main objectives: 1) fit a multivariate dynamic linear model to empirical population abundance estimates similar to NOAA's dBSR, 2) conduct a trend analyses with the most recent 10 years of data to compare patterns across populations, 3) estimate the proportion of populations currently meeting the QET, and 4) use the trend analysis results to predict future population status assuming recent environmental patterns and trends continue.


@ford_biological_2022 examined sp/su Chinook Salmon and steelhead 15-year (2004-2019) population trends using the fitted slope parameter from a linear regression model with year as the independent variable. From our initial examination of abundance data at the aggregate (i.e., Lower Granite Dam) and population levels, it appeared that abundance was relatively low in the beginning and end of the 15-year time period used in @ford_biological_2022. We hypothesized that linear models fit to the last 15 years of population data would effectively be anchored at similar beginning and end points, resulting in less steep trends and potential insignificant slope parameters. We decided to alter the dBSA approach, and instead capture the magnitude of the more recent downward trend that we are currently experiencing. To do so, we choose to use only the last 10-years of abundance returns beginning in 2011. We based our rational on a visual change point (i.e., trend/slope switches direction from positive to negative) in sp/su Chinook Salmon and steelhead returns starting around 2011, and the desire to include two generations of returns to capture contemporary patterns in population trends.


Need to put into context of climate change

we should include some assumptions and possible outcomes if violated

Need to compare and contrast across other findings; Storch et al., WDFWs....

Unfortunately, many climate prediction models suggest a continued warming phase in the northern hemisphere that will increase the vulnerability and risk of extinction for Columbia River anadromous fish [@crozierClimateVulnerabilityAssessment2019a]. Additionally, intensive population modeling by @crozierClimateChangeThreatens2021 suggests that a continued reduction in ocean survival, largely driven by climate change, will perpetuate the decline of Snake River sp/su Chinook Salmon populations with most reaching QET in the next 10-30 years.

The best fitting models for sp/su Chinook Salmon and steelhead describe biological processes that are logical and match our expectations and understanding of the system. Populations within an MPG are geographically close, often have similar habitat and rearing conditions, exposed to relatively similar migration distances, and managed with similar goals and objectives [@copeland_how_2024]. It stands to reason populations with these similar underlying traits would have a similar trend. Beginning in the late 1970's, after the last mainstem dam was constructed on the Lower Snake River, populations became more synchronous and showed less annual run-size diversity (\@ref(fig.synchronicity)). Thus, a common process variance and co-variance between MPG processes match our expectation that populations respond similarly to out-of-basin factors. Last, observations in each time-series are often generated by data collected at different spatial and temporal scales within the population, and analyzed by different people and agencies using different methods. Unequal variances across time-series also make sense.

The Lower Snake River and Clearwater River populations showed the fastest rate of decline over the last 10 years. These areas are lowest in elevation and contain some of the most degraded habitat in the basin.

The models indicated population time-series have been largely stationary since 1980 when the analysis began, with short periods of increases and decreases. Currently, the Snake River Basin is experiencing a declining trend that has, or will, push many populations to below the quasi-extinction threshold if continued. Species recovery after reaching this depressed state will be difficult and will require a major improvement in their environment to increase productivity. Productivity increases may come from a cooler climate and more hospitable ocean conditions, restored habitat and migration corridors, or the combination of many items. The model is clear, however, despite the fish management actions taken over the last 45 years, populations have seen little to no improvement, and recently started declining at a faster rate than previously observed.


What has the count of QET populations been across time?

Our analysis was intended to offer us a greater understanding of NOAA's dBSA, but instead yielded dire results that call for action. We learned that all sp/su Chinook Salmon populations experienced the same rate of decline (19\%) from 2011-2020, and the decline was remarkably similar to the common steelhead population decline (18%). We also learned that 13 sp/su Chinook Salmon populations (42%) are currently at levels considered "quasi-extinct", and 24 (77%) will be at the extinction risk threshold if current trends continue. Fewer steelhead populations (n = 3, 19%) are experiencing an immediate risk of extinction, but their rate of decline suggest seven (44%) populations will reach QET within 5-years.

Our linear predictions assume the current 10-year trend will continue, ignores serial correlation, and disregards important environmental drivers that may be cyclical (e.g., pacific decadal oscillation). Spawn year 2021 returns of sp/su Chinook Salmon and steelhead have returned in higher numbers than we predicted and provide a good example to discuss. The higher realized returns in 2021, resulting from recently improved ocean conditions, were not predicted by our model, but they were also not unexpected. Given our model and assumptions, our predictions should be viewed more as a long-term average trend. We did not attempt to predict actual annual returns by capturing year-to-year variability, management changes, and fluctuating environmental conditions. Instead, we were interested in understanding the average return across years and populations; thus, actual returns are expected to be higher and lower than our results. And although the higher returns of 2021 are welcomed, they still fall short of delisting criteria thresholds, and healthy and harvestable goals.

In the last 30 years since ESA listing of salmon and steelhead, billions of dollars were spent to recover and increase salmon and steelhead returns to the the Snake River. The actions we have taken included small and large scale habitat restoration projects, major hydrosystem over halls and passage improvements, and we have released millions of hatchery fish to jump start recovery. Although each of these actions have provided small localized benefits, our analysis shows Snake River anadromous populations are acting similarly, which suggests common drivers of survival for all populations (i.e., hydrosystem and ocean). Climate change scenarios predict worsen ocean conditions for salmon and steelhead, of which, our actions can not immediately change or improve. We can, however, change and improve migration and rearing conditions for all salmon and steelhead in the Lower Snake River and Columbia River.


Need comparison to other snake river status reports
-->

# Code and Data Availability

The code and processed data to reproduce the analyses, summaries, tables, and figures are available on the GitHub project repository at [https://github.com/ryankinzer/SRAFS.git](https://github.com/ryankinzer/SRAFS.git). Raw time-series observation data are available from Stream Net's Coordinated Assessments Indicators of Fish Population Health web application; [https://cax.streamnet.org](https://cax.streamnet.org).

# Acknowledgements

Providing the current status of Snake River fish stocks would not be possible without the gigantic efforts of hundreds of biologists, technicians, and field crews who have collected monitoring data across the basin over the past three decades. We are especially grateful to the many tribal, state, and federal agency staff whose long-term dedication to data collection, stewardship, and recovery efforts have provided the foundation for this analysis. We also thank the regional biologists and data managers who ensured the consistency and integrity of datasets spanning multiple generations of monitoring programs. Evan Brown, Rebecca Waskovich and Luciano Chiramonte from Idaho Department of Fish and Game, Joseph Feldhaus and Kasey Bliesner from Oregon Department of Fish and Wildlife, and Ethan Crawford and Michael Gallinat from Washington Department of Fish and Wildlife deserve a special thanks for meeting our data requests and helping us understand the methods and nuances. We thank our, now retired, program manager, David B. Johnson, for encouraging this work and using it to guide future recovery decisions and inform policy makers. Manuscript review and guidance pre-journal submittal were generously provided by **placeholder**, **placeholder**, **placeholder**, and **placeholder**. We also extend our gratitude to the anonymous journal reviewers whose thoughtful feedback greatly improved the quality and clarity of this manuscript.

```{=latex}
\clearpage
```

# References

<div id="refs"></div>
\printbibliography[heading=none]
\def\printbibliography{}

<!-- ```{=latex} -->
<!-- \printbibliography[heading=none] -->
<!-- ``` -->

<!-- <div id="refs"></div> -->

```{=latex}
\clearpage
```


```{=latex}
\appendix
\renewcommand{\thefigure}{S\arabic{figure}}  % Number figures as S1, S2, ...
\setcounter{figure}{0}
```

# Supplemental Material

```{r chn-resids, fig.pos = "H", out.width = '100%', eval = TRUE, fig.cap = 'Residuals from the best fitting spring-summer Chinook Salmon MARSS model.'}
include_graphics(paste0(fig_path,'Chinook_salmon/Chinook_salmon_residuals_',yr,'.png'))
```

```{r sth-resids,  fig.pos = "H", out.width = '100%', eval = TRUE, fig.cap = 'Residuals from the best fitting summer steelhead MARSS model.'}
include_graphics(paste0(fig_path,'Steelhead/Steelhead_residuals_',yr,'.png'))
```

```{r chn-targets, out.width = '100%', eval = TRUE, fig.cap = 'Modeled abundance estimates of natural-origin Snake River spring/summer Chinook Salmon relative to the quasi-extinction, minimum viable abundance, and health and harvestable thresholds.'}
include_graphics(paste0(fig_path,'Chinook_salmon/Chinook_salmon_pop_thresholds_',yr,'.png'))
```

```{r sth-targets, out.width = '100%', eval = TRUE, fig.cap = 'Modeled abundance estimates of natural-origin Snake River summer steelhead relative to the quasi-extinction, minimum viable abundance, and health and harvestable thresholds.'}
include_graphics(paste0(fig_path,'Steelhead/Steelhead_pop_thresholds_',yr,'.png'))
```